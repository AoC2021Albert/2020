m=[("mask","XX001001X10X110X0001111001110X110101"),
(3250,4436),
(48892,14455),
(25137,1097),
(57377,5760),
(25785,20344),
(54660,1936),
("mask","100110X00X0X11010101110110X00001XX0X"),
(20413,182815763),
(49549,9522935),
(29920,32420282),
(63511,9773),
(59685,980),
("mask","1110000111001X0100001011000X10X00X10"),
(28709,2381953),
(53254,100644575),
(20622,1013234),
(46518,7512916),
(49118,39485),
(50666,8298665),
(58287,107999),
("mask","111000000110X1010010011XX100X0000001"),
(12805,6015),
(20190,106469491),
(11123,8571),
(16350,3024),
(37958,29213622),
("mask","11000000011011010X01011011XX100011XX"),
(29717,194765),
(40119,1357487),
("mask","1X1000100X10X1000X01XX11000101011011"),
(53311,5028191),
(38550,30559161),
(37724,446421839),
(27658,656376),
(36878,491),
(2514,711969106),
(8425,25352),
("mask","10101000X110X1X1000101X1000100011001"),
(57587,156077909),
(8983,5589),
(21832,16170971),
(40748,14124),
(18993,3053),
(16438,2330074),
("mask","11100X000XX11X110001100000X0010111XX"),
(48379,719),
(8903,345168600),
(50733,6133),
(41283,24831),
(65183,84558),
(54817,98834),
("mask","1X10000X01X0110100X0X111000X00XX000X"),
(3941,450868),
(6069,2088),
(40200,2865),
(46518,5389),
(48814,19396),
("mask","01X0100X11111100100XX10X110110X0X001"),
(20385,15270930),
(15395,13898910),
(19502,2459689),
(5270,61362490),
("mask","0100100111XXX100X0010100X111X0100X0X"),
(58709,17455712),
(14865,176745),
(2952,54766095),
("mask","111000X0X1001100010X11X0X01X00XX1011"),
(39517,38586),
(38266,1003448),
(54660,154097),
("mask","1X0X00X00110110100011111100X01010111"),
(4521,360234),
(10967,699075),
(34096,89),
(21340,3018),
(12820,24007),
(46518,1732),
("mask","010X10XX0110111XX0000X0X10111000011X"),
(37473,213255),
(17466,126749),
("mask","11XX0010110X1X0001X11001X11001001X11"),
(34419,4401033),
(51972,547595351),
(29267,2460627),
(39192,15067),
("mask","11X0X0000110111XXXX1011010X000X11101"),
(51442,31937),
(16518,7405326),
(63834,1488732),
(26265,1190),
("mask","01001X01110110X110XX0X010X100X110X00"),
(8150,41274),
(9998,26361),
(2495,198393),
(25041,6310180),
(5890,20465),
("mask","1XXX00100110110000011X0101XX0100XX10"),
(26607,1384959),
(58709,31743),
(8993,56827),
(53062,258857),
(21305,672194),
("mask","10XX100X01101X11X0X1001001X01X110X10"),
(55577,128659409),
(19002,845525),
(14584,8317876),
("mask","11X0X00X010011XX000X1X100X110X010101"),
(9998,494334359),
(592,950827),
(13221,8704),
(23131,29048231),
("mask","1110X0X10100110100X0100X01010010000X"),
(18567,243296),
(27202,304731),
(24869,25916650),
(57135,23996),
("mask","110001XX11001101100001XX00X111110010"),
(34304,84360),
(31615,3771),
(34225,3477),
(58931,2972),
("mask","010X100XX1001X0111001000X011X1000100"),
(27987,8009299),
(1668,99817),
(55978,39150409),
(26420,236757),
("mask","1X1000XX01011011X0X111X0010000101100"),
(1117,280),
(4280,406684),
(31615,461997),
(17710,656126),
(19869,6759059),
(29930,25157555),
("mask","1XX01000011011110X0110011XX0XX1X1100"),
(9998,158930980),
(56595,290347),
(62495,2154029),
(13139,240824),
(37955,1962062),
(59685,23811),
("mask","111000100X1X110100010100XX0X11X11001"),
(61927,3404),
(53925,1029),
(4604,2697020),
("mask","10XXXXX0010X11010101110X1X0100X10011"),
(36423,187983079),
(35715,28051066),
(60426,2732),
(13855,1771),
(31615,4663854),
("mask","1110X100X1111111X000X00000X010000001"),
(4522,630),
(10122,1023763273),
(43180,53901),
("mask","010010110X0XX111100X00X000X00110X001"),
(55120,9489901),
(44935,74420893),
(46825,517159),
(28078,312928319),
(15205,129861),
(4958,925787),
(3152,269),
("mask","11100X00110X1100010X1X1101011010X001"),
(13451,3404810),
(27534,8632174),
(14401,3040),
(8542,3926892),
("mask","X010000101001101000010110X00010X1X01"),
(9740,117232),
(53779,32144),
(14267,62550),
(31615,1580737),
(8195,212112887),
(26629,300),
("mask","111001X10X0001000000X11001000X1010X1"),
(36441,709),
(30737,11941),
(25335,184614),
(36260,901),
("mask","1001011001X0X10101011X0010000X000101"),
(52419,1941048),
(50006,2164),
("mask","11100101010XX1X1101100101010X0001111"),
(59199,40929064),
(45560,6749),
(16449,535),
("mask","01001001X11011XXX00X01X10111X01101X0"),
(27668,115726141),
(34331,2819615),
(4631,1432),
(50121,101482650),
(27656,2138214),
(25426,491626),
("mask","010010X1X1XXXXX1100100000011X1100100"),
(14401,92822),
(33872,479638),
(54211,32497707),
(61337,98669),
(50724,111542),
("mask","XX0X1001111X11001X010000000X00101000"),
(15715,1986),
(20256,81993455),
("mask","010X10011X011001100101X0X00101X0010X"),
(14131,6366),
(11512,119948),
(27055,2537),
(53483,4819251),
(43180,513),
(50965,28334),
("mask","100X100011001X0X0101X10X1X000X000110"),
(34393,32931383),
(27316,22411579),
(9842,39791616),
("mask","X101001001101XXX000X1101111101101011"),
(39194,1039606),
(1043,19870767),
(43519,12559302),
("mask","1X000000010X1101X101111XX0X001XX0X11"),
(32350,799729),
(16251,144705569),
(29478,252441),
(34509,132421118),
(38139,205501387),
(41867,1221),
("mask","1X1000010100X10X0000111110XXX0X01XX0"),
(50371,55426),
(46715,237008),
(49071,29175),
(21421,301905),
(14865,182450),
(4521,431828838),
("mask","X10X101111101011XX010XX0100100X000X1"),
(16125,16228),
(29267,896900),
(33394,492137129),
(13125,29576953),
(15725,7205),
(14584,204223954),
("mask","11100001011X11010XX00111010X100X01X1"),
(61082,450817865),
(26585,4330327),
(10154,17401),
(2580,204),
("mask","1X1XXX0101001X1000000010100101000011"),
(33232,366048141),
(32350,262845291),
(11566,1065195),
(2881,4069871),
(50230,15284),
("mask","111X000101001100X11001X111110X00X0X0"),
(4769,124213132),
(39679,31372778),
(49788,397),
(37380,125852),
(12731,1652900),
(50954,126510477),
("mask","101XX0000X0X11000101X10X110101X0011X"),
(42090,862),
(16720,830),
(54268,1964148),
(47479,43971),
(39495,242510335),
("mask","1X0000010100X11100X11101011111X1X101"),
(53660,7408),
(59155,912),
(41194,3873),
(45140,150741374),
(2517,34604969),
("mask","1X011001111011001X01X1X0X011001X10X0"),
(49361,1299),
(3338,250),
(19712,901211202),
("mask","10X100X101X0X101011011X1X1100XX0X001"),
(17360,21666),
(12874,5813),
(29072,190751470),
(5281,107765),
(35992,10587613),
(27723,14464308),
("mask","1110X10001001111000X1010001001XX0011"),
(37958,4007715),
(48168,1633),
(33037,1157056),
(51789,57397),
(15715,1173117),
(48835,147582),
(36664,16384131),
("mask","X1100X000110110X0X0101X1100011010101"),
(46968,5167575),
(19400,68398),
(22943,290141),
(33183,6398),
("mask","11000010X10X11000X0101010111100001X0"),
(34426,1044218),
(23605,22524637),
(46715,90353789),
(47901,31588865),
(51647,5864),
(7817,5435304),
(51837,786823673),
("mask","11X010000XX01111XX011001X001X01011X1"),
(57040,31166252),
(9242,8336389),
(27098,1346),
(59253,233889),
(18975,2608708),
(32618,186139),
("mask","010011XX110110001101X000X1110101010X"),
(7283,474),
(65183,17576835),
(15496,917),
(61222,354),
(17141,130253),
(36668,1713209),
("mask","11X00001011011010110XX1011X0X00000X1"),
(7492,5456594),
(5028,5940),
("mask","010010110111000110001100X0X0011XX100"),
(34509,317267839),
(11256,29196358),
(16438,695),
(37251,240270619),
("mask","1011X00101XX101100X1X01110XX1X011100"),
(13870,10134037),
(19869,14129),
(40162,37930),
("mask","1X1000X001001100010111X1100X00001000"),
(58709,11947856),
(35950,885104),
(34703,228034631),
("mask","11000X0X11101X0X1XX010X0011111100101"),
(47331,14465),
(5333,257444),
(45140,482719),
(52463,2886),
(865,5635911),
(50116,1828),
("mask","1110X00101001101001X01X10101001XX101"),
(1952,88398932),
(19656,542717423),
(37210,56544559),
("mask","101X000X0100X10000000011100X00011011"),
(51972,174486661),
(54660,1063144),
(38089,103346160),
("mask","01X010010110111X1X0XX1X101XXX1110110"),
(37724,554486),
(26754,184956326),
(29860,1351),
(992,36303),
("mask","111X010101001111X0X1XX100X1X11X00011"),
(27208,4254),
(35726,9530),
(33400,54939),
(57377,36404),
("mask","1XX100X00101X101010111X0000110110011"),
(19330,95529570),
(55888,7245735),
(13178,210652128),
(37957,8777),
(27055,4557),
("mask","11X0X0000X00X10100X010000X1X00X11001"),
(28997,7527074),
(58911,3749437),
("mask","1010000101001XX000X0111X01111011XX01"),
(50800,3045),
(8405,778),
("mask","10X1100XX10X110X0101110X10XX00X10111"),
(8118,44193690),
(31080,6253993),
(51058,98518676),
(26420,444510),
(52332,773),
(43569,12978747),
("mask","110X00XX0101X1000001110X1110X0011011"),
(40259,29595),
(27022,1047145),
(39212,1022111),
(44256,827),
("mask","X0X0100X01101XX1000100100X1000X0XX00"),
(46808,16282111),
(39194,17358),
(30519,15329),
(20210,89741114),
(43471,209821),
(26479,51192892),
("mask","01X01XX1010101X1X00X0X0110X000X00000"),
(610,66868634),
(14693,1561),
("mask","01XX1X1101100001000XX001011111001X1X"),
(55624,1153),
(42873,95238952),
(52863,49132161),
(47893,4835),
("mask","11100X0X01XX1111000XX0000011000X1011"),
(12004,371040455),
(8773,1811),
(24918,1494696),
(40159,423055),
(53311,8179367),
(4769,62185497),
("mask","10100010010X1101X10X11101100X000111X"),
(1028,1420),
(55933,939),
(52023,787),
(44935,31931),
("mask","101XX00X010111XX010XX11011000010X111"),
(41496,35439),
(10603,5594),
("mask","0X0XX0011101010110X100111011XX00X101"),
(20002,178),
(52106,14251319),
(39635,772),
(4453,14389),
(38406,61303502),
("mask","XX0XX10111X0110110001XX00011010X0001"),
(46208,200581589),
(17134,19364192),
(13554,180),
(1525,16657222),
(29930,88470),
(20027,26218),
(33212,3420),
("mask","100X000X01XX11X10X01X11100101XX11101"),
(42427,3148),
(31191,34227921),
(5332,6209),
("mask","100000X00101X1011101011XX10001101011"),
(588,105317709),
(58944,49932),
(41156,5686),
(52429,79254),
(39164,125502),
(58384,9863),
("mask","11XX100001001101010111X010X100XX001X"),
(55325,532371),
(10714,945),
(40811,831),
(52429,825),
(29287,871309),
("mask","X1101001X11111001X00110011010011X01X"),
(5694,159997822),
(19902,7576),
(36358,23397),
(25700,8539929),
(3736,46206727),
(39212,59153),
(2356,1111),
("mask","1X1010XXX10011000000X100001101010101"),
(47918,1863009),
(26437,2046435),
(24918,29543865),
("mask","1XXX0001011011010XX001100110100XXXX0"),
(59155,12119),
(52,257262763),
(5137,620),
(14069,510285),
(45621,7565142),
("mask","110010X1010011010X01111X00X00X00011X"),
(19157,105432818),
(30121,19003),
(42427,14622666),
(17182,404866351),
("mask","0X001X11X0001X1110000100010011100101"),
(50733,259882372),
(26223,36),
(24717,82286),
(27043,59822),
("mask","1X10X0X1010011X0000001110011101X0X01"),
(6273,14023),
(60272,1284478),
(15323,181763),
(10258,48496693),
(4604,1283),
(59253,1501),
("mask","1X10X00001X011X101X111X11X0XX0011111"),
(52632,827829147),
(61514,896166427),
(39212,7083),
("mask","0100X011011000011XX1010100X101000110"),
(46696,3938),
(30717,486164),
(50113,1183),
(55797,7813),
(35980,2864),
(42957,1731),
(12885,5877830),
("mask","111X00X1XXX011010X0001100X0100100110"),
(53412,1122),
(3544,1936),
("mask","010010X1011X00X1XX0X100100X01XX00011"),
(26404,129912657),
(42427,8283676),
(49540,225057700),
("mask","111000000X10111101111101X000XX01100X"),
(6581,15005),
(34987,1525),
(53399,4281310),
("mask","01001X01110X1X0X1X0X1XX00101X0110000"),
(23101,1016018),
(8773,15572),
(41940,86213860),
("mask","1XX000X001X0110X0X011111XX010X011111"),
(12004,4210),
(57042,18456),
(4521,345391317),
(59155,2065415),
(55543,832584),
(25785,358916),
(30737,3867770),
("mask","0100100X0110110X000101100X1101X11001"),
(7028,1311),
(26146,15688934),
(45948,11724085),
(24060,7928),
(47218,6801),
(3544,1164),
("mask","010XX011011000110X0010X1010X10011001"),
(27498,49),
(46338,7293),
(63695,2760),
(26607,570024),
(386,305561631),
("mask","11100X01X100010000X01110111XX10110X1"),
(5811,21737791),
(64396,31213894),
(3250,73337),
(61337,54481),
(36423,25022),
(25426,14959),
(4801,1704),
("mask","1110000101X0X10X0X1011XX0101X00001X0"),
(3844,952254),
(60487,6495),
(42029,18562446),
(7631,6846),
(9377,93575),
("mask","1110000001X01XX10001X110000X1X101101"),
(10374,550602),
(5332,339),
(38039,1028545),
("mask","1101001001X0110XX001X1XX101101011011"),
(58473,143),
(47893,122),
(64544,6555692),
(22943,23337528),
(55147,889075),
(35980,24521),
("mask","101X0001010X111000001XXX01X00111X101"),
(23886,248921),
(29588,352528),
(48835,518717801),
(51363,892)]

mem = dict()
mask = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
for p in m:
    if p[0] == "mask":
        mask = p[1]
        mask0 =  2 ** len(mask) - 1
        mask1 = 0
        for i,c in enumerate(mask):
            if c == "0":
                mask0 = mask0 & ~(1 << (len(mask) - 1 - i))
            if c == "1":
                mask1 = mask1 | (1 << (len(mask) - 1 - i))
    else:
        mem[p[0]] = (p[1] & mask0) | mask1
print("a", sum(v for v in mem.values()))

#b
mem = dict()
mask = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
for p in m:
    if p[0] == "mask":
        mask = p[1]
        mask0 =  2 ** len(mask) - 1
        mask1 = 0
        maskx = []
        for i,c in enumerate(mask):
            if c == "1":
                mask1 = mask1 | (1 << (len(mask) - 1 - i))
            if c == "X":
                mask0 = mask0 & ~(1 << (len(mask) - 1 - i))
                maskx.append(i)
    else:
        if maskx:
            baseaddr = (p[0] & mask0) | mask1
            for bits in range(2**len(maskx)):
                addr = baseaddr
                # We bet a list with the bits of `bits`. Probably can be done nicer.
                bitslist = [int(b) for b in list(format(bits, '0'+str(len(maskx))+'b'))]
                for bitpos in range(len(maskx)):
                    addr = addr | (bitslist[bitpos] << (len(mask) - 1 - maskx[bitpos]))
                mem[addr] = p[1]
                print(f"p[0]: {p[0]}, maskx: {maskx}, bitslist: {bitslist}, mask: \n{mask}, baseaddr: \n{format(baseaddr,'036b')}, addr: \n{format(addr,'036b')}")
        else:
            mem[p[0] | mask1] = p[1]
print("a", sum(v for v in mem.values()))
